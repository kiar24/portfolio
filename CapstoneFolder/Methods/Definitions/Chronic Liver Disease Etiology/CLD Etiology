SELECT 
    LabTestsUpdated_MeldFilter.person_id,
    LabTestsUpdated_MeldFilter.CovidTest_Date,
    condition_occurrence.condition_concept_id,
    condition_occurrence.condition_start_date,
     CASE
        -- Cirrhosis (1 if present, 0 if absent)
        WHEN condition_occurrence.condition_concept_id IN (
            192675, 192680, 194692, 196463, 199837, 444246, 605193, 3539899, 3656096, 4003673, 4012013, 4030392, 
            4046016, 4046123, 4048057, 4048083, 4049282, 4049419, 4050640, 4053079, 4055209, 4055210, 4055211, 
            4055212, 4055213, 4058680, 4058681, 4058682, 4058684, 4058695, 4059280, 4059281, 4059284, 4059285, 
            4059287, 4059289, 4062023, 4064161, 4071022, 4093164, 4096793, 4098583, 4140536, 4141628, 4143008, 
            4144116, 4144117, 4148254, 4153294, 4159158, 4184779, 4203168, 4203601, 4207818, 4232955, 4246999, 
            4252074, 4268006, 4277276, 4292401, 4294539, 4300060, 4304584, 4309163, 4313567, 4331292, 4340386, 
            4340390, 4340392, 4340393, 4340945, 4340946, 36716711, 37017151, 37017293, 37110890, 37111265, 37111266, 
            37117933, 37396157, 37396401, 40317575, 40317576, 40346332, 40346413, 40384183, 40393749, 40393760, 
            40393763, 40393768, 40393769, 40393775, 40393782, 40438004, 40438006, 40490872, 40634954, 42539566, 
            43531723, 44783142, 44805713, 45769564, 45771017, 45772057) THEN 1
        ELSE 0
    END AS Cirrhosis_Status,
    CASE 
        WHEN condition_occurrence.condition_concept_id IN (
            1175300, 1175663, 1176919, 1177021, 1401905, 1402137, 1402138, 1402139, 1402140, 
            1402141, 1402399, 1406565, 19298465, 3173071, 3189077, 3293487, 3293693, 3446437, 
            3449827, 3453367, 3455148, 3458599, 3466076, 3473084, 35826357, 36402911, 36525074, 
            36533174, 36538815, 36542147, 36545431, 36558585, 36566482, 36770574, 37162050, 
            37162058, 37162060, 37162686, 37163155, 37163403, 4028536, 4029506, 4029980, 4030023,
            4099699, 4101758, 4166154, 4180407, 4293980, 4342124, 44503833, 44503834, 44500015, 
            44501488, 44501716, 44502018, 44502019, 44502698, 45615498, 45617533, 46270968, 
            45429855, 45456319, 45456406, 45470002, 46462968, 
            37162058, 37162060, 37164403, 1423222, 37163155, 37207648, 42513130, 42513129, 
            42513132, 42513127, 42513128, 42513131, 42514093, 42513133, 1402399, 37162050, 
            46270968, 3453367, 44502019, 36533174, 1402141, 3458599, 4029980, 44498775, 
            44502018, 36538815, 1402140, 3455148, 4028536, 44498774, 36558585, 36525074, 
            3437448, 4029981, 44498777, 44503833, 44501488, 1402139, 44498772, 44503834, 
            36542147, 1402138, 3449827, 4048870, 44498773, 44502698, 36566482, 1402137, 
            3446437, 4029506, 44498776, 37158722, 36402911, 45456319, 3293487, 3473084, 
            4101758, 4099699, 45617533, 3293693, 44500015, 36545431, 44501716, 42512949, 
            42512539, 4166154, 1401905, 3466076, 3173071, 4180407, 44498778, 36687200, 
            37162859, 36715924, 3215830, 36717496, 3325470, 36715923, 3310136, 1417601, 
            1417602, 200762, 3571434, 42489928, 45426906, 45601188, 3286386, 35208356, 
            44837177, 37162862, 1417572, 37162686, 45456406, 45429855, 45470002, 
            3189077, 
            36770574, 
            1175663, 
            1175300, 
            40762539, 
            4246127, 
            36770656, 
            4324202, 
            36770544, 
            36770672, 
            36770211, 
            35951861, 
            36770407, 
            36769265
        ) 
        THEN 1 
        ELSE 0 
    END AS Hepatocellular_Carcinoma_Status,
    CASE 
            WHEN condition_occurrence.condition_concept_id IN (
                22340, 24966, 4237824, 4111998, 28779, 4087310, 4112183, 46269816, 
                46269835, 46273476, 200528, 199863, 4245975, 377604, 46269836, 
                46269818, 196029, 200031, 439672, 4159144, 1417575, 37396401, 1417574, 
                3238867, 1417572
            ) 
            THEN 1
            WHEN condition_occurrence.condition_concept_id IN (192675, 192680, 194692, 196463, 199837, 444246, 605193, 3539899, 3656096, 4003673, 4012013, 4030392, 
            4046016, 4046123, 4048057, 4048083, 4049282, 4049419, 4050640, 4053079, 4055209, 4055210, 4055211, 
            4055212, 4055213, 4058680, 4058681, 4058682, 4058684, 4058695, 4059280, 4059281, 4059284, 4059285, 
            4059287, 4059289, 4062023, 4064161, 4071022, 4093164, 4096793, 4098583, 4140536, 4141628, 4143008, 
            4144116, 4144117, 4148254, 4153294, 4159158, 4184779, 4203168, 4203601, 4207818, 4232955, 4246999, 
            4252074, 4268006, 4277276, 4292401, 4294539, 4300060, 4304584, 4309163, 4313567, 4331292, 4340386, 
            4340390, 4340392, 4340393, 4340945, 4340946, 36716711, 37017151, 37017293, 37110890, 37111265, 37111266, 
            37117933, 37396157, 40317575, 40317576, 40346332, 40346413, 40384183, 40393749, 40393760, 
            40393763, 40393768, 40393769, 40393775, 40393782, 40438004, 40438006, 40490872, 40634954, 42539566, 
            43531723, 44783142, 44805713, 45769564, 45771017, 45772057)
            THEN 0
            ELSE NULL
        END AS Decompensated_Cirrhosis_Status,
    CASE
        WHEN condition_occurrence.condition_concept_id IN (28779, 4087310, 4112183, 4237283, 37162854, 37162855, 37162859, 37162857, 37162856, 37162853, 22665, 24076, 26441, 26727, 30770, 192671, 193249, 193250, 193795, 194680, 196442, 197018, 197925, 198467, 199855, 200137, 201885, 433515, 434402, 435855, 436148, 436729, 437021, 437027, 437323, 437326, 438468, 438796, 440583, 441062, 441063, 441328, 443779, 4027729, 4054952, 4103703, 4164920, 4169592, 4174044, 4211001, 4217947, 4231580, 4232181, 4247008, 4274491, 4289830, 4294973, 4336230, 45757247, 45757654, 45757783, 46269837, 46269907, 46270145, 46270529, 46273183, 23245) 
        THEN 1
        ELSE 0
    END as Varices_Bleeding_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id IN (194983, 200528, 4061363, 4061510, 4061770, 4061771, 4342883, 43020550, 43020551, 46269816, 46269817, 46269835, 46273476) 
        THEN 1
        ELSE 0
    END as Ascites_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id IN (254061, 40316579, 4011137, 4024105, 4024106, 4145862, 3536144, 3536891, 46274130, 254390, 3545743, 4140910, 4325194, 43021728, 40396420, 40396428, 40490395, 4051342, 4052555, 1415865, 3655446, 4171684, 45605897, 1415869, 761746, 46269700, 3655265, 4192493, 4215765, 45586684, 4025163, 3536890, 40316581, 40345771, 3655266, 3655445, 4236658, 40396981, 44801224) 
        THEN 1
        ELSE 0
    END as Pleural_Effusion_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id = 199863
        THEN 1
        ELSE 0
    END as Spontaneous_Bacterial_Peritonitis_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id IN (196029, 200031, 372892, 373764, 377604, 380834, 436222, 439672, 439675, 4029488, 4308946, 43021132, 46269818, 46269836, 46270037, 3176072, 42710029, 1246027) 
        THEN 1
        ELSE 0
    END as Hepatic_Encephalopathy_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id = 196455 
        THEN 1
        ELSE 0
    END as Hepatorenal_Syndrome_New,
   
    CASE
        WHEN condition_occurrence.condition_concept_id IN (22665, 24076, 26441, 26727, 30770, 192671, 193249, 193250, 193795, 194680, 196442, 197018, 197925, 198467, 199855, 200137, 201885, 433515, 434402, 435855, 436148, 436729, 437021, 437027, 437323, 437326, 438468, 438796, 440583, 441062, 441063, 441328, 443779, 4027729, 4054952, 4103703, 4164920, 4169592, 4174044, 4211001, 4217947, 4231580, 4232181, 4247008, 4274491, 4289830, 4294973, 4336230, 45757247, 45757654, 45757783, 46269837, 46269907, 46270145, 46270529, 46273183, 23245, 28779, 4112183)
        THEN 1
        ELSE 0
    END as Gastrointestinal_Bleeding_New
FROM LabTestsUpdated_MeldFilter
LEFT JOIN condition_occurrence
ON LabTestsUpdated_MeldFilter.person_id = condition_occurrence.person_id;
